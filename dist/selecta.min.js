!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,s){return void 0===s&&(s="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(s),s}:e(jQuery)}(function(e){"use strict";var t="Selecta",s=e(window),a=function(t,s){var a=this;a.$select=e(t),a.props={multi:void 0!==a.$select.attr("multiple"),enabled:!1,classes:void 0!==a.$select.attr("class")&&a.$select.attr("class").split(" ")},a.triggers={init:"selecta-init",open:"selecta-open",close:"selecta-closed",change:"selecta-change",populated:"selecta-populated",refresh:"selecta-refresh"},a.classes={container:"selecta",select:"selecta-hidden",label:"selecta-label",labelWrapper:"selecta-label-wrapper",items:"selecta-items",multi:"selecta-multi",placeholder:"selecta-placeholder",hover:"selecta-hover",itemHover:"highlighted",itemSelected:"selected",above:"above",open:"selecta-open",native:"selecta-native",optgroup:"selecta-items-group",grouplabel:"selecta-items-group-label",invalid:"selecta-invalid"},a.init(s)};a.prototype={init:function(a){var l=this;if(l.params=e.extend(!0,{},e.fn[t].defaults,l.params,a),l.$select.addClass(l.classes.select).wrap(l.params.template.main),l.$container=l.$select.closest("."+l.classes.container),l.$label=l.$container.find("."+l.classes.label),l.$items=l.$container.find("."+l.classes.items),l.params.detectMobile?l.props.mobile=l.params.detectMobile():l.props.mobile="object"==typeof Modernizr&&Modernizr.touchevents?Modernizr.touchevents:!(!s[0].matchMedia||!s[0].matchMedia("only screen and (max-width: 48rem)").matches),l.props.multi&&l.$container.addClass(l.classes.multi),l.params.firstAsPlaceholder?(l.$placeholder=l.$select.find("option").first(),l.$placeholder.addClass(l.classes.placeholder)):l.$placeholder=l.$select.find("."+l.classes.placeholder),l.params.class){var i=l.$container.attr("class");l.$container.addClass(i+" "+l.params.class)}if(l.props.classes&&l.$container.addClass("s-"+l.props.classes[0]),l.props.mobile&&l.params.nativeOnMobile&&(l.$container.addClass(l.classes.native),l.$select.on("change",function(e){l.$select.trigger(l.triggers.change,l)})),l.$select.on("change "+l.triggers.init+" "+l.triggers.populated+" "+l.triggers.refresh+" "+l.triggers.change,function(){var t="",s=l.$select.val();if(l.$items.find("li").removeClass(l.classes.itemSelected),s&&""!==s&&s!=l.$placeholder.val())if(l.props.multi){var a=e(l.params.template.label);a.addClass(l.classes.labelWrapper);for(var i=0;i<s.length;i++){var r=l.$select.find('option[value="'+s[i]+'"]'),n=e(l.params.template.pill).attr("data-value",s[i]).text(r.text());n.one("click",function(t){t.preventDefault(),t.stopPropagation(),l.deselect(e(this).attr("data-value"))}),a.append(n),l.$items.find('li[data-value="'+s[i]+'"]').addClass(l.classes.itemSelected)}t=a}else{r=l.$select.find('option[value="'+s+'"]');t=e(l.params.template.label).addClass(l.classes.labelWrapper).text(r.text()),l.$items.find('li[data-value="'+s+'"]').addClass(l.classes.itemSelected)}else t=e(l.params.template.placeholder).addClass(l.classes.labelWrapper).text(l.$placeholder.text())[0],l.$placeholder.attr("disabled",!0);l.writeLabel(t)}),l.$select.on(l.triggers.open,function(){var e=l.$items.find("li").first().outerHeight(),t=l.$items.find("li").length,a=l.params.show,i=l.$container.offset().top-s.scrollTop(),r=l.$container.innerHeight(),n=s.innerHeight();l.params.show>t&&(a=t);var o=a*e;o+i+r>n?l.params.forceRenderBelow||l.$items.addClass(l.classes.above):l.$items.removeClass(l.classes.above),l.$items.css({"max-height":o/16+"rem"})}).on(l.triggers.close,function(){l.$items.css({"max-height":"0"}),l.$items.find("li").removeClass(l.classes.itemHover)}),l.$select.on("blur",function(e){e.preventDefault(),e.stopPropagation(),l.props.mobile&&l.params.nativeOnMobile?l.$container.removeClass(l.classes.open):l.closeTimer=window.setTimeout(function(){l.$container.removeClass(l.classes.open),l.$select.trigger(l.triggers.close,l)},250)}).on("focus",function(e){e.preventDefault(),e.stopPropagation(),l.$container.addClass(l.classes.open),l.props.mobile&&l.params.nativeOnMobile||(window.clearTimeout(l.closeTimer),l.keys="",l.$select.trigger(l.triggers.open,l))}).on("keydown",function(e){e.preventDefault(),e.stopPropagation(),l.props.mobile&&l.params.nativeOnMobile||9==e.which||l.keypress(e.which)}),l.$container.on("click",function(e){if(!l.props.mobile||!l.params.nativeOnMobile){if(e.stopPropagation(),e.preventDefault(),l.$container.hasClass(l.classes.open))return l.$select.trigger("blur"),void l.$select.triggerHandler("blur");l.$select.trigger("focus"),l.$select.triggerHandler("focus")}}),l.params.validateOnSubmit){var r=l.$select.closest("form");e.contains(r[0],l.$select[0])&&r.on("submit",function(e){!l.$select.prop("required")||l.$select.val()!=l.$placeholder.val()&&null!==l.$select.val()&&""!==l.$select.val()||(l.$container.addClass(l.classes.invalid),l.$select.one("change",function(){l.$container.removeClass(l.classes.invalid)}),e.preventDefault())})}l.props.mobile||l.$container.on("mouseenter",function(){l.$container.addClass(l.classes.hover)}).on("mouseleave",function(){l.$container.removeClass(l.classes.hover)}),l.populate(),l.$select.trigger(l.triggers.init,l)},populate:function(){var t=this,s=t.$select.find("optgroup"),a=t.$select.find("option");if(t.length=0,t.items=[],s.length){a.first().attr("disabled",!0);var l=1,i=e("<ul></ul>");s.each(function(s,a){i.append('<li class="'+t.classes.grouplabel+'" data-index="'+l+'">'+e(a).attr("label")+"</li>"),e(a).find("option").each(function(s,a){l++;var r=e(t.params.template.item).text(e(a).text()).attr("data-value",e(a).val()).attr("data-index",l);i.append(r),t.items.push({value:e(a).val(),text:e(a).text().toLowerCase()}),t.length++}),l++}),t.$items.append(i)}else t.$items.html("<ul></ul>"),a.each(function(s,a){var l=t.$select.children().eq(s),i=t.$items.find("ul");if(!l.attr("disabled")&&!l.hasClass(t.classes.placeholder)){var r=e(t.params.template.item).text(l.text()).attr("data-index",s).attr("data-value",l.val());i.append(r),t.items.push({value:e(a).val(),text:e(a).text().toLowerCase()}),t.length++}});t.$items.off("click").on("click","li",function(s){s.stopPropagation();var a=e(s.target);a.hasClass(t.classes.grouplabel)||(t.select(a),(t.props.multi||t.params.keepOpen)&&(window.clearTimeout(t.closeTimer),t.$select.triggerHandler("focus"),t.$select.trigger("focus")))}),t.props.mobile||t.$items.find("li").not("."+t.classes.grouplabel).off("mouseenter").on("mouseenter",function(s){t.$items.find("li").removeClass(t.classes.itemHover),e(s.target).addClass(t.classes.itemHover)}),t.$items.attr("data-length",t.length),t.$select.trigger(t.triggers.populated,t)},select:function(e){var t=this,s=t.$select.find('option[value="'+e.attr("data-value")+'"]');t.props.multi?s.prop("selected")?s.prop("selected",!1):s.prop("selected",!0):(t.$select.find("option").prop("selected",!1),s.prop("selected",!0)),t.$select.trigger("change"),t.$select.trigger(t.triggers.change,t)},deselect:function(e){var t=this;t.$select.find('option[value="'+e+'"]').prop("selected",!1),t.$select.trigger("change"),t.$select.trigger(t.triggers.change,t)},keypress:function(e){var t=this;switch(e){case 32:t.$container.trigger("click");break;case 13:var s=t.$items.find("li.highlighted");s.length?t.select(s):t.$container.trigger("click");break;case 27:t.$select.trigger("blur");break;case 37:case 38:t.highlight("prev");break;case 39:case 40:t.highlight("next");break;default:(e>=48&&e<=57||e>=65&&e<=90)&&(t.keys+=String.fromCharCode(e).toLowerCase(),t.lookup(t.keys))}},lookup:function(e){var t=this,s=!1;if(t.items.some(function(t){return 0===t.text.indexOf(e)})){for(var a=0;a<t.items.length;a++)if(0===t.items[a].text.indexOf(e)){s=a;break}t.highlight(t.items[s].value)}else t.keys=""},highlight:function(e){var t=this,s=t.$items.find("li."+t.classes.itemHover).length?t.$items.find("li."+t.classes.itemHover).first():t.$items.find("li."+t.classes.itemSelected).first(),a=!1;if(t.$container.hasClass(t.classes.open)){switch(e){case"prev":a=s.length?s.prevAll("li").not("."+t.classes.grouplabel).first():t.$items.find("li").not("."+t.classes.grouplabel).first();break;case"next":a=s.length?s.nextAll("li").not("."+t.classes.grouplabel).first():t.$items.find("li").not("."+t.classes.grouplabel).first();break;default:a=t.$items.find('li[data-value="'+e+'"]')}a.length&&(t.$items.find("li").removeClass(t.classes.itemHover),a.addClass(t.classes.itemHover),t.curr=a.attr("data-value"),t.$items.animate({scrollTop:a.outerHeight()*(a.attr("data-index")-1)},"fast"))}},refresh:function(){this.populate(),this.$select.trigger(this.triggers.refresh,this)},writeLabel:function(e){this.$label.html(e)}},e.fn[t]=function(s){return this.each(function(){var l=e.data(this,t);"object"==typeof l?"string"==typeof s&&l[s]?l[s]():"object"==typeof s&&s!=l.params&&l[s.action]&&l[s.action](s.options):e.data(this,t,new a(this,s))})},e.fn[t].defaults={firstAsPlaceholder:!0,show:5,template:{main:'<div class="selecta"><div class="selecta-element"></div><div class="selecta-label"></div><div class="selecta-items"></div></div>',item:"<li></li>",label:"<span></span>",placeholder:'<span class="selecta-label-placeholder"></span>',pill:'<span class="selecta-pill"></span>'}}});